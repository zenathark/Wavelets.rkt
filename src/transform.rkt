#lang typed/racket/base

(require math/array
         racket/vector)

(provide Orthogonal-Filter
         Lifting-Step
         Lifting-Filter
         Biorthogonal-Filter
         orthogonal-filters)

(struct Wavelet-Filter ())

(struct Orthogonal-Filter Wavelet-Filter ([name           : Keyword]
                                          [scaling-coeff  : (Array Flonum)]))

(struct Biorthogonal-Filter Wavelet-Filter ([name            : Symbol]
                                            [scaling-coeff   : (Array Flonum)]
                                            [inverse-scaling : (Array Flonum)]))

(define-type Lifting-Step-Type (U 'update 'predict))

(struct Lifting-Step ([type  : Lifting-Step-Type]
                      [coef  : (Array Flonum)]
                      [shift : Positive-Integer]))

(struct Lifting-Filter Wavelet-Filter ([steps        : (Array Lifting-Step)]
                                       [odd-scaling  : Flonum]
                                       [even-scaling : Flonum]))

(: filters (Vectorof (Pair Keyword (Vectorof Flonum))))

(define filters
  #[(#:haar . #[0.7071067811865475 0.7071067811865475])

    ;; Coiflet filters
    (#:coif2 . #[-0.072732619513 0.337897662458 0.852572020212 0.384864846864 -0.072732619513 -0.015655728135])

    (#:coif4 . #[0.0163873364635998 -0.0414649367819558 -0.0673725547222826 0.3861100668229939 0.8127236354493977 0.4170051844236707 -0.0764885990786692 -0.0594344186467388 0.0236801719464464 0.0056114348194211 -0.0018232088707116 -0.0007205494453679])

    (#:coif6 . #[-0.0037935128644910 0.0077825964273254 0.0234526961418362 -0.0657719112818552 -0.0611233900026726 0.4051769024096150 0.7937772226256169 0.4284834763776168 -0.0717998216193117 -0.0823019271068856 0.0345550275730615 0.0158805448636158 -0.0090079761366615 -0.0025745176887502 0.0011175187708906 0.0004662169601129 -0.0000709833031381 -0.0000345997728362])

    (#:coif8 . #[0.0008923136685824 -0.0016294920126020 -0.0073461663276432 0.0160689439647787 0.0266823001560570 -0.0812666996808907 -0.0560773133167630 0.4153084070304910 0.7822389309206135 0.4343860564915321 -0.0666274742634348 -0.0962204420340021 0.0393344271233433 0.0250822618448678 -0.0152117315279485 -0.0056582866866115 0.0037514361572790 0.0012665619292991 -0.0005890207562444 -0.0002599745524878 0.0000623390344610 0.0000312298758654 -0.0000032596802369 -0.0000017849850031])

    (#:coif10 . #[-0.0002120808398259 0.0003585896879330 0.0021782363583355 -0.0041593587818186 -0.0101311175209033 0.0234081567882734 0.0281680289738655 -0.0919200105692549 -0.0520431631816557 0.4215662067346898 0.7742896037334738 0.4379916262173834 -0.0620359639693546 -0.1055742087143175 0.0412892087544753 0.0326835742705106 -0.0197617789446276 -0.0091642311634348 0.0067641854487565 0.0024333732129107 -0.0016628637021860 -0.0006381313431115 0.0003022595818445 0.0001405411497166 -0.0000413404322768 -0.0000213150268122 0.0000037346551755 0.0000020637618516 -0.0000001674428858 -0.0000000951765727])

    ;; Symmlet filter
    (#:sym4 . #[0.0455703458960000 -0.0178247014420000 -0.1403176241790000 0.4212345342040000 1.1366582434079999 0.7037390686560000 -0.0419109651250000 -0.1071489014180000])

    (#:sym5 . #[0.0276321529580000 -0.0298424998690000 -0.2479513626130000 0.0234789231360000 0.8965816483800000 1.0230529668940000 0.2819906968540000 -0.0553441861170000 0.0417468644220000 0.0386547959550000])

    (#:sym6 . #[-0.0110318675090000 0.0024999220930000 0.0632505626600000 -0.0297837512990000 -0.1027249698620000 0.4779043713330000 1.1138927839260000 0.6944579729580000 -0.0683231215870000 -0.1668632154120000 0.0049366123720000 0.0217847003270000])

    (#:sym7 . #[0.0145213947620000 0.0056713426860000 -0.1524638718960000 -0.1980567068070000 0.4081839397250000 1.0857827098140000 0.7581626019640000 0.0246656594890000 -0.0700782912220000 0.0960147679360000 0.0431554525820000 -0.0178704316510000 -0.0014812259150000 0.0037926585340000])

    (#:sym8 . #[-0.0047834585120000 -0.0007666908960000 0.0448236230420000 0.0107586117510000 -0.2026486552860000 -0.0866536154060000 0.6807453471900000 1.0991066305370001 0.5153986703740000 -0.0734625087610000 -0.0384935212630000 0.0694904659110000 0.0053863887540000 -0.0211456865280000 -0.0004283943000000 0.0026727933930000])

    (#:sym9 . #[0.0019811937360000 0.0008765025390000 -0.0187693968360000 -0.0163033512260000 0.0427444336020000 0.0008251409290000 -0.0771721610970000 0.3376589236020000 1.0152597908320000 0.8730484073490000 0.0498828309590000 -0.2708937835030000 -0.0257864459300000 0.0877912515540000 0.0125288962420000 -0.0145155785530000 -0.0006691415090000 0.0015124873090000])

    (#:sym10 . #[-0.0006495898960000 0.0000806612040000 0.0064957283750000 -0.0011375353140000 -0.0287862319260000 0.0081528167990000 0.0707035675500000 -0.0452407722180000 -0.0502565400920000 0.5428130112130000 1.0882515305000000 0.6670713381540000 -0.1002402150310000 -0.2255589722340000 0.0164188694260000 0.0649509245790000 -0.0020723639230000 -0.0122206426300000 0.0001352450200000 0.0010891704470000])

    ;; Battle-Lemarie filter
    (#:batt2 . #[-0.0000867523000000 -0.0001586010000000 0.0003617810000000 0.0006529220000000 -0.0015570100000000 -0.0027458800000000 0.0070644200000000 0.0120030000000000 -0.0367309000000000 -0.0488618000000000 0.2809310000000000 0.5781630000000000 0.2809310000000000 -0.0488618000000000 -0.0367309000000000 0.0120030000000000 0.0070644200000000 -0.0027458800000000 -0.0015570100000000 0.0006529220000000 0.0003617810000000 -0.0001586010000000 -0.0000867523000000])

    (#:batt4 . #[0.0001033070000000 -0.0001642640000000 -0.0002018180000000 0.0003267490000000 0.0003959460000000 -0.0006556200000000 -0.0007804680000000 0.0013308600000000 0.0015462400000000 -0.0027452900000000 -0.0030786300000000 0.0057993200000000 0.0061414300000000 -0.0127154000000000 -0.0121455000000000 0.0297468000000000 0.0226846000000000 -0.0778079000000000 -0.0354980000000000 0.3068300000000000 0.5417360000000000 0.3068300000000000 -0.0354980000000000 -0.0778079000000000 0.0226846000000000 0.0297468000000000 -0.0121455000000000 -0.0127154000000000 0.0061414300000000 0.0057993200000000 -0.0030786300000000 -0.0027452900000000 0.0015462400000000 0.0013308600000000 -0.0007804680000000 -0.0006556200000000 0.0003959460000000 0.0003267490000000 -0.0002018180000000 -0.0001642640000000 0.0001033070000000])

    (#:batt6 . #[0.0001011130000000 0.0001107090000000 -0.0001591680000000 -0.0001726850000000 0.0002514190000000 0.0002698420000000 -0.0003987590000000 -0.0004224850000000 0.0006355630000000 0.0006628360000000 -0.0010191200000000 -0.0010420700000000 0.0016465900000000 0.0016413200000000 -0.0026864600000000 -0.0025881600000000 0.0044400200000000 0.0040788200000000 -0.0074684800000000 -0.0063988600000000 0.0128754000000000 0.0099063500000000 -0.0229951000000000 -0.0148537000000000 0.0433544000000000 0.0208414000000000 -0.0914068000000000 -0.0261771000000000 0.3128690000000000 0.5283740000000000 0.3128690000000000 -0.0261771000000000 -0.0914068000000000 0.0208414000000000 0.0433544000000000 -0.0148537000000000 -0.0229951000000000 0.0099063500000000 0.0128754000000000 -0.0063988600000000 -0.0074684800000000 0.0040788200000000 0.0044400200000000 -0.0025881600000000 -0.0026864600000000 0.0016413200000000 0.0016465900000000 -0.0010420700000000 -0.0010191200000000 0.0006628360000000 0.0006355630000000 -0.0004224850000000 -0.0003987590000000 0.0002698420000000 0.0002514190000000 -0.0001726850000000 -0.0001591680000000 0.0001107090000000 0.0001011130000000])

    ;; Beylkin filter
    (#:beyl . #[0.0993057653740000 0.4242153608130000 0.6998252140570000 0.4497182511490000 -0.1109275983480000 -0.2644972314460000 0.0269003088040000 0.1555387318770000 -0.0175207462670000 -0.0885436306230000 0.0196798660440000 0.0429163872740000 -0.0174604086960000 -0.0143658079690000 0.0100404118450000 0.0014842347820000 -0.0027360316260000 0.0006404853290000])

    ;; Vaidyanathan filter
    (#:vaid . #[-0.0000629061180000 0.0003436319050000 -0.0004539566200000 -0.0009448971360000 0.0028438345470000 0.0007081375040000 -0.0088391034090000 0.0031538470560000 0.0196872150100000 -0.0148534480050000 -0.0354703986070000 0.0387426192930000 0.0558925236910000 -0.0777097509020000 -0.0839288843660000 0.1319716614170000 0.1350842271290000 -0.1944504717660000 -0.2634948024880000 0.2016121617750000 0.6356010598720000 0.5727977932110000 0.2501841295050000 0.0457993341110000])])

(: make-orthogonal-filter (-> Keyword (Listof Flonum) Orthogonal-Filter))
(define (make-orthogonal-filter name coef)
  (Orthogonal-Filter name (list->array coef)))

(: orthogonal-filters (Listof Orthogonal-Filter))
;; (define orthogonal-filters (list (make-orthogonal-filter '#:test #[0.0])))
(define orthogonal-filters (map (Î»: ([i : (Pair Keyword (Vectorof Flonum))])
                                  (make-orthogonal-filter (car i) (vector->list (cdr i))))
                                (vector->list filters)))
